(function(e){function t(t){for(var i,n,o=t[0],u=t[1],c=t[2],l=0,f=[];l<o.length;l++)n=o[l],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&f.push(r[n][0]),r[n]=0;for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(e[i]=u[i]);d&&d(t);while(f.length)f.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],i=!0,o=1;o<a.length;o++){var u=a[o];0!==r[u]&&(i=!1)}i&&(s.splice(t--,1),e=n(n.s=a[0]))}return e}var i={},r={app:0},s=[];function n(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=i,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=u;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("cd49")},cd49:function(e,t,a){"use strict";a.r(t);var i=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("router-view")],1)},s=[],n=i["a"].extend({name:"App"}),o=n,u=a("2877"),c=Object(u["a"])(o,r,s,!1,null,null,null),d=c.exports,l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"editor"}},[a("editor-controller",{attrs:{"selected-key":e.selectedKey,"load-score-data-str":e.loadScoreDataStr,"load-music-url":e.loadMusicUrl}})],1)},f=[],p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"editor-controller"}},[a("editor-main",{attrs:{"page-num":e.pageNum,"load-score-data":e.scoreData,"load-music-url":e.loadMusicUrl,"key-config":e.keyConfig,"key-kind":e.keyKind,timing:e.timing,"prop-score-number":e.scoreNumber,"music-volume":e.musicVolume,"music-rate":e.musicRate},on:{"page-minus":e.pageMinus,"page-plus":e.pagePlus,"page-jump":e.pageJump}}),a("editor-option",{attrs:{scoreNumber:e.scoreNumber,musicVolume:e.musicVolume,musicRate:e.musicRate},on:{"update:scoreNumber":function(t){e.scoreNumber=t},"update:score-number":function(t){e.scoreNumber=t},"update:musicVolume":function(t){e.musicVolume=t},"update:music-volume":function(t){e.musicVolume=t},"update:musicRate":function(t){e.musicRate=t},"update:music-rate":function(t){e.musicRate=t}}}),a("editor-save",{on:{save:e.save}}),a("div",{attrs:{id:"editor-menu"}},[a("div",{staticClass:"menu-item-container",attrs:{id:"menu-page"}},[e._m(0),a("div",{staticClass:"menu-move-display"},[a("div",{staticClass:"menu-move-btn",on:{click:function(t){return e.pageMinus(5)}}},[e._v("◁")]),a("div",{staticClass:"menu-move-btn",on:{click:function(t){return e.pageMinus(1)}}},[e._v("◁")]),a("div",{staticClass:"menu-move-txt"},[e._v(e._s(e.pageNum))]),a("div",{staticClass:"menu-move-btn",on:{click:function(t){return e.pagePlus(1)}}},[e._v("▷")]),a("div",{staticClass:"menu-move-btn",on:{click:function(t){return e.pagePlus(5)}}},[e._v("▷")])])]),a("div",{staticClass:"menu-item-container",attrs:{id:"menu-label"}},[a("div",{staticClass:"menu-move-header"},[a("div",{staticClass:"menu-txt"},[e._v("Label")]),a("input",{ref:"label-checkbox",staticClass:"uk-checkbox",attrs:{id:"menu-label-checkbox",type:"checkbox",disabled:1===e.pageNum},domProps:{checked:-1!==e.getLabelNumByPageNum(e.pageNum)},on:{click:e.callLabelOperation}})]),a("div",{staticClass:"menu-move-display"},[a("div",{staticClass:"menu-move-btn",on:{click:function(t){return e.labelMinus(5)}}},[e._v("◁")]),a("div",{staticClass:"menu-move-btn",on:{click:function(t){return e.labelMinus(1)}}},[e._v("◁")]),a("div",{staticClass:"menu-move-txt"},[e._v(e._s(e.labelNum))]),a("div",{staticClass:"menu-move-btn",on:{click:function(t){return e.labelPlus(1)}}},[e._v("▷")]),a("div",{staticClass:"menu-move-btn",on:{click:function(t){return e.labelPlus(5)}}},[e._v("▷")])])]),a("div",{staticClass:"menu-item-container",attrs:{id:"menu-adj"}},[a("div",{staticClass:"menu-txt"},[e._v("Blank Frame")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.scoreData.blankFrame,expression:"scoreData.blankFrame",modifiers:{number:!0}}],staticClass:"uk-input uk-form-small",attrs:{type:"number",step:"0.01"},domProps:{value:e.scoreData.blankFrame},on:{input:function(t){t.target.composing||e.$set(e.scoreData,"blankFrame",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),a("div",{staticClass:"menu-item-container",attrs:{id:"menu-sn"}},[a("div",{staticClass:"menu-txt"},[e._v("Start Number")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.timing.startNum,expression:"timing.startNum",modifiers:{number:!0}}],staticClass:"uk-input uk-form-small",attrs:{type:"number",step:"0.01"},domProps:{value:e.timing.startNum},on:{input:function(t){t.target.composing||e.$set(e.timing,"startNum",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),a("div",{staticClass:"menu-item-container",attrs:{id:"menu-bpm"}},[a("div",{staticClass:"menu-txt"},[e._v("BPM")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.timing.bpm,expression:"timing.bpm",modifiers:{number:!0}}],staticClass:"uk-input uk-form-small",attrs:{type:"number",step:"0.01"},domProps:{value:e.timing.bpm},on:{input:function(t){t.target.composing||e.$set(e.timing,"bpm",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),a("div",{staticClass:"menu-item-container",attrs:{id:"menu-output"}},[a("a",{staticClass:"menu-output-btn btn-orange",attrs:{href:"#editor-option","uk-toggle":""}},[e._v("OPTION")]),a("div",{staticClass:"menu-output-btn btn-gray",on:{click:e.convertWithQuarters}},[e._v(" TEST ")]),a("div",{staticClass:"menu-output-btn btn-blue",attrs:{href:"#editor-save","uk-toggle":""}},[e._v(" SAVE ")]),a("div",{staticClass:"menu-output-btn btn-gray",on:{click:e.displayScoreDataInfo}},[e._v(" CALC ")]),a("div",{staticClass:"menu-output-btn btn-red",on:{click:e.convert}},[e._v("GO!")])])]),a("router-link",{staticClass:"uk-modal-close-default editor-close",attrs:{type:"button",href:"../","uk-close":"",to:{name:"start",path:"/"}}})],1)},h=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"menu-move-header"},[a("div",{staticClass:"menu-txt"},[e._v("Page")])])}],m=a("9ab4"),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"editor-main"}},[a("div",{ref:"canvas",attrs:{id:"canvas",tabindex:"-1"},on:{keydown:function(t){return t.preventDefault(),e.keydownAction.apply(null,arguments)}}}),e._l(e.scoreData.scores[e.page-1].speeds,(function(t,i){return a("speed-piece",{key:i,attrs:{position:t.position,type:t.type,isReverse:e.isReverse},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"speed.value"}})})),a("div",{attrs:{id:"editor-mode-text"}},[e._v(" 入力間隔: "+e._s(e.mode)+"分 ("+e._s(e.moveIntervalFrame)+"F) ")])],2)},y=[],g=a("362d"),_=a.n(g),b=function(){function e(e){this.speeds=[],this.notes=new Array(e).fill([]).map((function(){return[]})),this.freezes=new Array(e).fill([]).map((function(){return[]}))}return e}(),K=30,z=5,k=384,S=k,D=k/8,N=60,w=50,C=25,P=["#ff0000","#0000ff","#00cc00","#ff9000"],L=["#ff4dd2","#00ffff","#ceff00","#c99b7d"],O=["#fff0ff","#f0f0ff","#f0fff0","#fff0dd"],R=function(){function e(e){this.audio=e,this.context=new AudioContext,e.load();var t=this.context.createMediaElementSource(e),a=this.context.createGain();t.connect(a),a.connect(this.context.destination),this.gainNode=a}return e.prototype.play=function(e,t,a){var i=this;this.gainNode.gain.value=t,this.audio.playbackRate=a;var r=this.audio.duration;r>e&&(this.audio.currentTime=e,e<0?setTimeout((function(){return i.audio.play()}),1e3*-e):this.audio.play())},e.prototype.pause=function(e){this.audio.pause(),clearTimeout(e)},e}();function x(e,t){return t?e:k-e}var F=a("2ef0"),M=function(){function e(e,t,a,i,r,s,n){var o;this.scoreData=e,this.keyConfig=t,this.keyKind=a,this.isReverse=i,this.stage=r,this.notesLayer=s,this.operationQueue=n,this.keyNum=this.keyConfig[this.keyKind].num,this.isHighlightedFreeze=JSON.parse(null!==(o=localStorage.getItem("isHighlightedFreeze"))&&void 0!==o?o:"true")}return e.prototype.hasNote=function(e,t,a){var i=this.scoreData.scores[e-1],r=i.freezes[t].includes(a),s=i.notes[t].includes(a)||r;return{exists:s,isFreeze:r}},e.prototype.add=function(e,t,a,i){i?this.scoreData.scores[e-1].freezes[t].push(a):this.scoreData.scores[e-1].notes[t].push(a)},e.prototype.remove=function(e,t,a){var i=this.scoreData.scores[e-1].freezes[t].filter((function(e){return e!==a}));this.scoreData.scores[e-1].freezes.splice(t,1,i);var r=this.scoreData.scores[e-1].notes[t].filter((function(e){return e!==a}));this.scoreData.scores[e-1].notes.splice(t,1,r)},e.prototype.draw=function(e,t,a){var i=this.stage,r=this.notesLayer,s=this.keyConfig[this.keyKind].colorGroup,n=a?L[s[e]]:P[s[e]],o=new _.a.Rect({x:e*K,y:x(t,this.isReverse)-z/2,width:K,height:z,fill:n,id:"note-"+e+"-"+t});r.add(o),i.add(r)},e.prototype.clear=function(e,t){var a=this.stage,i=this.notesLayer,r=i.findOne("#note-"+e+"-"+t);r.destroy(),a.add(i)},e.prototype.addOne=function(e,t,a,i,r){this.add(e,a,i,r),e===t&&this.draw(a,i,r),r&&this.fillFreeze(t,a),this.operationQueue.push({type:"ADD_NOTE",page:e,position:i,lane:a,isFreeze:r})},e.prototype.removeOne=function(e,t,a,i){this.remove(e,a,i),e===t&&this.clear(a,i),this.fillFreeze(t,a);var r=this.hasNote(e,a,i),s=r.exists,n=r.isFreeze;s&&this.operationQueue.push({type:"REMOVE_NOTE",page:e,position:i,lane:a,isFreeze:n})},e.prototype.fillFreeze=function(e,t){var a;if(!this.isHighlightedFreeze)return!1;var i=this.stage,r=this.notesLayer,s=this.keyConfig[this.keyKind].colorGroup,n=L[s[t]],o=Object(F["cloneDeep"])(this.scoreData.scores[e-1].freezes[t]).sort((function(e,t){return e-t})),u=this.scoreData.scores.reduce((function(a,i,r){return r<e-1?a+i.freezes[t].length:a}),0)%2;1===u&&o.unshift(0),o.push(k);var c=r.find(".freeze-fill-"+t);c.each((function(e){return e.destroy()}));while(o.length>0){var d=o.shift(),l=null!==(a=o.shift())&&void 0!==a?a:k,f=l-d,p=.3,h=new _.a.Rect({x:t*K,y:Math.min(x(d,this.isReverse),x(l,this.isReverse)),width:K,height:f,opacity:p,fill:n,name:"freeze-fill-"+t,id:"freeze-fill-"+t+"-"+d});r.add(h)}i.add(r)},e.prototype.removeLanes=function(e,t){for(var a=this.keyNum,i=[],r=0;r<a;r++){var s=this.hasNote(e,r,t);s.exists&&(this.remove(e,r,t),i.push({lane:r,isFreeze:s.isFreeze}))}return i},e.prototype.removeOnPosition=function(e,t){var a=this.removeLanes(e,t);this.operationQueue.push({type:"REMOVE_ON_POSITION",page:e,position:t,removedLanes:a})},e.prototype.addOnPosition=function(e,t,a){var i=this;a.forEach((function(a){return i.add(e,a.lane,t,a.isFreeze)}))},e.prototype.shift=function(e,t,a){var i=t+a,r=e;if(i<0){if(1===e)return;r--,i+=k}else i>=k&&(r++,i-=k);var s=this.removeLanes(e,t),n=this.removeLanes(r,i);this.addOnPosition(r,i,s),this.operationQueue.push({type:"SHIFT",page:e,position:t,newPage:r,newPosition:i,movedLanes:s,originalLanes:n})},e}(),T=function(){function e(e,t,a,i,r){this.scoreData=e,this.editorWidth=t,this.isReverse=a,this.stage=i,this.notesLayer=r}return e.prototype.hasSpeedPiece=function(e,t){return this.scoreData.scores[e-1].speeds.some((function(e){return e.position===t}))},e.prototype.add=function(e,t,a,i){void 0===i&&(i=1),this.scoreData.scores[e-1].speeds.push({position:t,value:i,type:a})},e.prototype.remove=function(e,t){this.scoreData.scores[e-1].speeds=this.scoreData.scores[e-1].speeds.filter((function(e){return e.position!==t}))},e.prototype.draw=function(e,t){var a=this.stage,i=this.notesLayer,r="speed"===t?"orange":"purple",s=6,n=new _.a.RegularPolygon({sides:3,radius:s,rotation:30,fill:r,x:this.editorWidth+s,y:x(e,this.isReverse),id:"speed-"+e});i.add(n),a.add(i)},e.prototype.clear=function(e){var t=this.stage,a=this.notesLayer,i=a.findOne("#speed-"+e);i.destroy(),t.add(a)},e}(),E=function(){function e(e,t,a,i,r){this.scoreData=e,this.copyScoreStore=t,this.keyNum=a,this.displayPageScore=i,this.operationQueue=r}return e.prototype.copy=function(e){var t=Object(F["cloneDeep"])(this.scoreData.scores[e-1]);this.copyScoreStore=t},e.prototype.clear=function(e){this.scoreData.scores.splice(e-1,1,new b(this.keyNum)),this.displayPageScore(e)},e.prototype.cut=function(e){this.copy(e),this.clear(e);var t=Object(F["cloneDeep"])(this.copyScoreStore);this.operationQueue.push({type:"CUT",page:e,copyScoreStore:t})},e.prototype.write=function(e,t){this.scoreData.scores.splice(e-1,1,t),this.displayPageScore(e)},e.prototype.paste=function(e,t){void 0===t&&(t=Object(F["cloneDeep"])(this.copyScoreStore)),this.write(e,t),this.operationQueue.push({type:"PASTE",page:e})},e.prototype.insert=function(e,t){this.scoreData.scores.splice(e-1,0,t);var a=this.scoreData.timings;this.scoreData.timings=a.map((function(t){return t.label>e&&t.label++,t})),this.displayPageScore(e)},e.prototype.add=function(e,t){void 0===t&&(t=Object(F["cloneDeep"])(this.copyScoreStore)),this.insert(e,t),this.operationQueue.push({type:"ADD_PAGE",page:e})},e.prototype.remove=function(e){this.scoreData.scores.splice(e-1,1);var t=this.scoreData.timings;this.scoreData.timings=t.map((function(t){return t.label>e&&t.label--,t})),this.displayPageScore(e)},e.prototype.delete=function(e){this.copy(e),this.remove(e);var t=Object(F["cloneDeep"])(this.copyScoreStore);this.operationQueue.push({type:"REMOVE_PAGE",page:e,copyScoreStore:t})},e}();function U(e,t,a,i){void 0===i&&(i=0);var r=60*N/D/e.bpm,s=i+e.startNum+(t-e.label)*k*r;return s+a*r}function j(e,t,a){var i=60*N/D/e.bpm,r=Math.round((t-a-e.startNum)/i),s=r;r%4==1?s=r-1:r%4==3&&(s=r+1);var n=Math.floor(s/k)+e.label,o=s%k;return{page:n,position:o}}function I(e,t,a,i){return void 0===i&&(i=0),U(e,t,a,i)/N}function G(e){var t=Math.floor(e/60),a=Math.floor(e%60),i=a<10?"0"+a:""+a;return t+":"+i}var A=function(){function e(e,t,a,i,r,s){this.scoreData=e,this.editorWidth=t,this.isReverse=a,this.stage=i,this.currentPositionLayer=r,this.changeCurrentPosition=s}return e.prototype.draw=function(e,t,a){var i=this.stage,r=this.currentPositionLayer,s="#d8d800",n=x(e,this.isReverse),o=r.findOne("#currentPositionLine"),u=o instanceof _.a.Line?o.y(n):new _.a.Line({y:n,points:[0,0,this.editorWidth,0],stroke:s,strokeWidth:1.75,id:"currentPositionLine"}),c=6,d=r.findOne("#currentPositionTriangle"),l=d instanceof _.a.RegularPolygon?d.y(n):new _.a.RegularPolygon({sides:3,radius:c,rotation:-30,fill:s,x:-c,y:n,id:"currentPositionTriangle"}),f=this.scoreData.blankFrame,p=U(a,t,e,f)<1e5?Math.round(10*U(a,t,e,f))/10:Math.round(U(a,t,e,f)),h=I(a,t,e,f),m=G(h),v=p+"\n["+m+"]",y=40,g=22,b=r.findOne("#currentPositionText"),K=b instanceof _.a.Text?b.y(n-g/2).text(v):new _.a.Text({width:y,height:g,text:v,fill:"black",fontSize:g/2,align:"center",x:2-w,y:n-g/2,id:"currentPositionText"});r.add(u,l,K),i.add(r)},e.prototype.move=function(e,t,a){this.changeCurrentPosition(e),this.draw(e,t,a)},e.prototype.musicAnimate=function(e){var t=this.stage,a=this.currentPositionLayer,i=a.findOne("#musicPosition"),r=i instanceof _.a.Line?i.y(x(0,this.isReverse)):new _.a.Line({y:x(0,this.isReverse),points:[0,0,this.editorWidth,0],stroke:"#8000ff",strokeWidth:1.75,id:"musicPosition"});a.add(r),t.add(a);var s=new _.a.Tween({node:r,duration:4*e/5/1e3,x:0,y:x(S,this.isReverse)});setTimeout((function(){s.play()}),e/5)},e}(),J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("input",{directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],staticClass:"editor-speed-piece",style:{top:e.top+"px"},attrs:{type:"number",step:"0.01"},domProps:{value:e.inputValue},on:{input:function(t){t.target.composing||(e.inputValue=t.target.value)}}})},H=[],$=i["a"].extend({name:"SpeedPiece",model:{prop:"propValue",event:"changeSpeed"},props:{isReverse:Boolean,position:Number,propValue:Number,type:{type:String}},computed:{top:function(){return x(this.position,this.isReverse)+15},inputValue:{get:function(){return this.propValue},set:function(e){var t=Number(e);this.$emit("changeSpeed",t)}}}}),V=$,W=Object(u["a"])(V,J,H,!1,null,null,null),B=W.exports;function Q(e,t,a){var i=e.pop();if(!i)return{};switch(i.type){case"ADD_NOTE":t.remove(i.page,i.lane,i.position);break;case"REMOVE_NOTE":t.add(i.page,i.lane,i.position,i.isFreeze);break;case"REMOVE_ON_POSITION":t.addOnPosition(i.page,i.position,i.removedLanes);break;case"SHIFT":t.addOnPosition(i.page,i.position,i.movedLanes),t.removeLanes(i.newPage,i.newPosition),t.addOnPosition(i.newPage,i.newPosition,i.originalLanes);break;case"CUT":a.write(i.page,i.copyScoreStore);break;case"PASTE":a.clear(i.page);break;case"ADD_PAGE":a.remove(i.page);break;case"REMOVE_PAGE":a.insert(i.page,i.copyScoreStore);break}return{undoPage:i.page||1,undoPosition:i.position||0}}var X={5:{id:1,num:5,keys:["KeyJ","KeyK","KeyI","KeyL","KeyG"],chars:["J","K","I","L","G"],alternativeKeys:["KeyS","KeyD","KeyE","KeyF","KeyH"],noteNames:["left_data","down_data","up_data","right_data","space_data"],freezeNames:["frzLeft_data","frzDown_data","frzUp_data","frzRight_data","frzSpace_data"],colorGroup:[0,0,0,0,2]},7:{id:2,num:7,keys:["KeyS","KeyD","KeyF","KeyG","KeyJ","KeyK","KeyL"],chars:["S","D","F","G","J","K","L"],alternativeKeys:["","","","KeyH","","",""],noteNames:["left_data","leftdia_data","down_data","space_data","up_data","rightdia_data","right_data"],freezeNames:["frzLeft_data","frzLdia_data","frzDown_data","frzSpace_data","frzUp_data","frzRdia_data","frzRight_data"],colorGroup:[0,1,0,2,0,1,0]},"7i":{id:3,num:7,keys:["KeyZ","KeyX","KeyC","KeyJ","KeyK","KeyI","KeyL"],chars:["Z","X","C","J","K","I","L"],alternativeKeys:["KeyS","KeyD","KeyF","","","KeyO",""],noteNames:["left_data","leftdia_data","down_data","space_data","up_data","rightdia_data","right_data"],freezeNames:["frzLeft_data","frzLdia_data","frzDown_data","frzSpace_data","frzUp_data","frzRdia_data","frzRight_data"],colorGroup:[1,1,1,0,0,0,0]},8:{id:4,num:8,keys:["KeyS","KeyD","KeyF","KeyG","KeyJ","KeyK","KeyL","Semicolon"],chars:["S","D","F","G","J","K","L","+"],alternativeKeys:["","","","KeyH","","","",""],noteNames:["left_data","leftdia_data","down_data","space_data","up_data","rightdia_data","right_data","sleft_data"],freezeNames:["frzLeft_data","frzLdia_data","frzDown_data","frzSpace_data","frzUp_data","frzRdia_data","frzRight_data","sfrzLeft_data"],colorGroup:[0,1,0,2,0,1,0,2]},"9A":{id:5,num:9,keys:["KeyS","KeyD","KeyE","KeyF","KeyG","KeyJ","KeyK","KeyI","KeyL"],chars:["S","D","E","F","G","J","K","I","L"],alternativeKeys:["","","KeyR","","KeyH","","","KeyO",""],noteNames:["left_data","down_data","up_data","right_data","space_data","sleft_data","sdown_data","sup_data","sright_data"],freezeNames:["frzLeft_data","frzDown_data","frzUp_data","frzRight_data","frzSpace_data","sfrzLeft_data","sfrzDown_data","sfrzUp_data","sfrzRight_data"],colorGroup:[0,0,0,0,2,1,1,1,1]},"9B":{id:6,num:9,keys:["KeyA","KeyS","KeyD","KeyF","KeyG","KeyJ","KeyK","KeyL","Semicolon"],chars:["A","S","D","F","G","J","K","L","+"],alternativeKeys:["","","","","KeyH","","","",""],noteNames:["left_data","down_data","up_data","right_data","space_data","sleft_data","sdown_data","sup_data","sright_data"],freezeNames:["frzLeft_data","frzDown_data","frzUp_data","frzRight_data","frzSpace_data","sfrzLeft_data","sfrzDown_data","sfrzUp_data","sfrzRight_data"],colorGroup:[1,0,1,0,2,0,1,0,1]},"9i":{id:7,num:9,keys:["KeyA","KeyS","KeyD","KeyF","KeyG","KeyJ","KeyK","KeyI","KeyL"],chars:["A","S","D","F","G","J","K","I","L"],alternativeKeys:["","","","","KeyH","","","KeyO",""],noteNames:["left_data","down_data","up_data","right_data","space_data","sleft_data","sdown_data","sup_data","sright_data"],freezeNames:["frzLeft_data","frzDown_data","frzUp_data","frzRight_data","frzSpace_data","sfrzLeft_data","sfrzDown_data","sfrzUp_data","sfrzRight_data"],colorGroup:[1,0,1,0,2,3,3,3,3]},11:{id:8,num:11,keys:["KeyS","KeyD","KeyF","KeyG","KeyJ","KeyK","KeyL","KeyU","KeyI","Digit8","KeyO"],alternativeKeys:["","","","KeyH","","","","","","Digit9",""],chars:["S","D","F","G","J","K","L","U","I","8","O"],noteNames:["left_data","leftdia_data","down_data","space_data","up_data","rightdia_data","right_data","sleft_data","sdown_data","sup_data","sright_data"],freezeNames:["frzLeft_data","frzLdia_data","frzDown_data","frzSpace_data","frzUp_data","frzRdia_data","frzRight_data","sfrzLeft_data","sfrzDown_data","sfrzUp_data","sfrzRight_data"],colorGroup:[0,1,0,2,0,1,0,3,3,3,3]},"11L":{id:9,num:11,keys:["KeyW","KeyE","Digit3","KeyR","KeyS","KeyD","KeyF","KeyG","KeyJ","KeyK","KeyL"],chars:["W","E","3","R","S","D","F","G","J","K","L"],alternativeKeys:["","","Digit4","","","","","KeyH","","",""],noteNames:["sleft_data","sdown_data","sup_data","sright_data","left_data","leftdia_data","down_data","space_data","up_data","rightdia_data","right_data"],freezeNames:["sfrzLeft_data","sfrzDown_data","sfrzUp_data","sfrzRight_data","frzLeft_data","frzLdia_data","frzDown_data","frzSpace_data","frzUp_data","frzRdia_data","frzRight_data"],colorGroup:[3,3,3,3,0,1,0,2,0,1,0]},"11W":{id:10,num:11,keys:["KeyS","KeyD","KeyF","KeyG","KeyJ","KeyK","KeyL","Digit2","KeyT","KeyY","Digit0"],chars:["S","D","F","G","J","K","L","2","T","Y","0"],alternativeKeys:["","","","KeyH","","","","Digit1","","","Minus"],noteNames:["left_data","leftdia_data","down_data","space_data","up_data","rightdia_data","right_data","sleft_data","sdown_data","sup_data","sright_data"],freezeNames:["frzLeft_data","frzLdia_data","frzDown_data","frzSpace_data","frzUp_data","frzRdia_data","frzRight_data","sfrzLeft_data","sfrzDown_data","sfrzUp_data","sfrzRight_data"],colorGroup:[0,1,0,2,0,1,0,2,3,3,2]},"11i":{id:11,num:11,keys:["KeyS","KeyC","KeyD","KeyE","KeyF","KeyG","KeyJ","KeyM","KeyK","KeyI","KeyL"],chars:["S","C","D","E","F","G","J","M","K","I","L"],alternativeKeys:["","KeyX","","KeyR","","KeyH","","Comma","","KeyO",""],noteNames:["left_data","down_data","gor_data","up_data","right_data","space_data","sleft_data","sdown_data","siyo_data","sup_data","sright_data"],freezeNames:["frzLeft_data","frzDown_data","frzGor_data","frzUp_data","frzRight_data","frzSpace_data","sfrzLeft_data","sfrzDown_data","sfrzIyo_data","sfrzUp_data","sfrzRight_data"],colorGroup:[0,0,2,0,0,2,1,1,2,1,1]},12:{id:12,num:12,keys:["KeyG","KeyN","KeyJ","KeyM","KeyK","Comma","KeyL","Period","KeyU","KeyI","Digit8","KeyO"],chars:["G","N","J","M","K","<","L",">","U","I","8","O"],alternativeKeys:["KeyH","","","","","","","","","","Digit9",""],noteNames:["oni_data","left_data","leftdia_data","down_data","space_data","up_data","rightdia_data","right_data","sleft_data","sdown_data","sup_data","sright_data"],freezeNames:["foni_data","frzLeft_data","frzLdia_data","frzDown_data","frzSpace_data","frzUp_data","frzRdia_data","frzRight_data","sfrzLeft_data","sfrzDown_data","sfrzUp_data","sfrzRight_data"],colorGroup:[2,0,1,0,1,0,1,0,3,3,3,3]},13:{id:13,num:13,keys:["KeyA","KeyS","KeyD","KeyF","KeyG","KeyJ","KeyK","KeyL","Semicolon","KeyU","KeyI","Digit8","KeyO"],chars:["A","S","D","F","G","J","K","L","+","U","I","8","O"],alternativeKeys:["","","","","KeyH","","","","","","","Digit9",""],noteNames:["left_data","down_data","up_data","right_data","space_data","sleft_data","sdown_data","sup_data","sright_data","tleft_data","tdown_data","tup_data","tright_data"],freezeNames:["frzLeft_data","frzDown_data","frzUp_data","frzRight_data","frzSpace_data","sfrzLeft_data","sfrzDown_data","sfrzUp_data","sfrzRight_data","tfrzLeft_data","tfrzDown_data","tfrzUp_data","tfrzRight_data"],colorGroup:[0,0,0,0,2,1,1,1,1,3,3,3,3]},14:{id:14,num:14,keys:["KeyG","KeyN","KeyJ","KeyM","KeyK","Comma","KeyL","Period","KeyY","KeyU","KeyI","Digit8","KeyO","KeyP"],chars:["G","N","J","M","K","<","L",">","Y","U","I","8","O","P"],alternativeKeys:["KeyH","","","","","","","","KeyT","","","Digit9","","BracketLeft"],noteNames:["oni_data","left_data","leftdia_data","down_data","space_data","up_data","rightdia_data","right_data","sleftdia_data","sleft_data","sdown_data","sup_data","sright_data","srightdia_data"],freezeNames:["foni_data","frzLeft_data","frzLdia_data","frzDown_data","frzSpace_data","frzUp_data","frzRdia_data","frzRight_data","sfrzLdia_data","sfrzLeft_data","sfrzDown_data","sfrzUp_data","sfrzRight_data","sfrzRdia_data"],colorGroup:[2,0,1,0,1,0,1,0,2,3,3,3,3,2]},"14i":{id:15,num:14,keys:["KeyZ","KeyX","KeyC","KeyS","KeyD","KeyF","KeyG","KeyJ","KeyK","KeyL","KeyU","KeyI","Digit8","KeyO"],chars:["Z","X","C","S","D","F","G","J","K","L","U","I","8","O"],alternativeKeys:["","","","","","","KeyH","","","","","","Digit9",""],noteNames:["gor_data","space_data","iyo_data","sleft_data","sleftdia_data","sdown_data","sspace_data","sup_data","srightdia_data","sright_data","left_data","down_data","up_data","right_data"],freezeNames:["frzGor_data","frzSpace_data","frzIyo_data","sfrzLeft_data","sfrzLdia_data","sfrzDown_data","sfrzSpace_data","sfrzUp_data","sfrzRdia_data","sfrzRight_data","frzLeft_data","frzDown_data","frzUp_data","frzRight_data"],colorGroup:[2,2,2,0,1,0,2,0,1,0,3,3,3,3]},15:{id:16,num:15,keys:["KeyW","KeyE","Digit3","KeyR","KeyS","KeyD","KeyF","KeyG","KeyJ","KeyK","KeyL","KeyU","KeyI","Digit8","KeyO"],chars:["W","E","3","R","S","D","F","G","J","K","L","U","I","8","O"],alternativeKeys:["","","Digit4","","","","","KeyH","","","","","","Digit9",""],noteNames:["sleft_data","sdown_data","sup_data","sright_data","left_data","leftdia_data","down_data","space_data","up_data","rightdia_data","right_data","tleft_data","tdown_data","tup_data","tright_data"],freezeNames:["sfrzLeft_data","sfrzDown_data","sfrzUp_data","sfrzRight_data","frzLeft_data","frzLdia_data","frzDown_data","frzSpace_data","frzUp_data","frzRdia_data","frzRight_data","tfrzLeft_data","tfrzDown_data","tfrzUp_data","tfrzRight_data"],colorGroup:[3,3,3,3,0,1,0,2,0,1,0,3,3,3,3]},"16i":{id:17,num:16,keys:["KeyZ","KeyX","KeyC","KeyA","KeyS","KeyD","KeyF","KeyG","KeyJ","KeyK","KeyL","Semicolon","KeyU","KeyI","Digit8","KeyO"],chars:["Z","X","C","A","S","D","F","G","J","K","L","+","U","I","8","O"],alternativeKeys:["","","","","","","","KeyH","","","","","","","Digit9",""],noteNames:["gor_data","space_data","iyo_data","sleft_data","sdown_data","sup_data","sright_data","aspace_data","aleft_data","adown_data","aup_data","aright_data","left_data","down_data","up_data","right_data"],freezeNames:["frzGor_data","frzSpace_data","frzIyo_data","sfrzLeft_data","sfrzDown_data","sfrzUp_data","sfrzRight_data","afrzSpace_data","afrzLeft_data","afrzDown_data","afrzUp_data","afrzRight_data","frzLeft_data","frzDown_data","frzUp_data","frzRight_data"],colorGroup:[2,2,2,1,0,1,0,2,0,1,0,1,3,3,3,3]},17:{id:18,num:17,keys:["KeyA","KeyZ","KeyS","KeyX","KeyD","KeyC","KeyF","KeyV","KeyG","KeyN","KeyJ","KeyM","KeyK","Comma","KeyL","Period","Semicolon"],chars:["A","Z","S","X","D","C","F","V","G","N","J","M","K","<","L",">","+"],alternativeKeys:["","","","","","","","","KeyH"],noteNames:["aleft_data","bleft_data","adown_data","bdown_data","aup_data","bup_data","aright_data","bright_data","space_data","cleft_data","dleft_data","cdown_data","ddown_data","cup_data","dup_data","cright_data","dright_data"],freezeNames:["afrzLeft_data","bfrzLeft_data","afrzDown_data","bfrzDown_data","afrzUp_data","bfrzUp_data","afrzRight_data","bfrzRight_data","frzSpace_data","cfrzLeft_data","dfrzLeft_data","cfrzDown_data","dfrzDown_data","cfrzUp_data","dfrzUp_data","cfrzRight_data","dfrzRight_data"],colorGroup:[0,1,0,1,0,1,0,1,2,1,0,1,0,1,0,1,0]},23:{id:23,num:23,keys:["KeyW","KeyE","Digit3","KeyR","KeyZ","KeyS","KeyX","KeyD","KeyC","KeyF","KeyV","KeyG","KeyN","KeyJ","KeyM","KeyK","Comma","KeyL","Period","KeyU","KeyI","Digit8","KeyO"],chars:["W","E","3","R","Z","S","X","D","C","F","V","G","N","J","M","K","<","L",">","U","I","8","O"],alternativeKeys:["","","Digit4","","","","","","","","","KeyH","","","","","","","","","","Digit9",""],noteNames:["aleft_data","adown_data","aup_data","aright_data","left_data","leftdia_data","down_data","space_data","up_data","rightdia_data","right_data","oni_data","sleft_data","sleftdia_data","sdown_data","sspace_data","sup_data","srightdia_data","sright_data","bleft_data","bdown_data","bup_data","bright_data"],freezeNames:["afrzLeft_data","afrzDown_data","afrzUp_data","afrzRight_data","frzLeft_data","frzLdia_data","frzDown_data","frzSpace_data","frzUp_data","frzRdia_data","frzRight_data","foni_data","sfrzLeft_data","sfrzLdia_data","sfrzDown_data","sfrzSpace_data","sfrzUp_data","sfrzRdia_data","sfrzRight_data","bfrzLeft_data","bfrzDown_data","bfrzUp_data","bfrzRight_data"],colorGroup:[3,3,3,3,0,1,0,1,0,1,0,2,0,1,0,1,0,1,0,3,3,3,3]}};function Z(){var e,t=localStorage.getItem("customKeyConfig");if(t){var a=JSON.parse(t);e=Object.assign(X,a)}else e=X;return e}var q=i["a"].extend({name:"EditorMain",props:{pageNum:Number,loadScoreData:{type:Object},loadMusicUrl:String,keyConfig:{type:Object},keyKind:{type:String},timing:{type:Object},propScoreNumber:Number,musicVolume:Number,musicRate:Number},components:{SpeedPiece:B},data:function(){var e,t=this.loadScoreData,a=Z(),i=this.keyKind,r=a[i].num,s=new Audio(this.loadMusicUrl),n=null!==(e=localStorage.getItem("isReverse"))&&void 0!==e?e:"false",o=JSON.parse(n),u=[];return{currentPosition:0,scoreData:t,divisor:24,page:1,keyNum:r,isReverse:o,editorWidth:K*a[i].num,musicService:new R(s),musicTimer:null,operationQueue:u,copyScoreStore:new b(r),currentPositionService:void 0,previousPosition:0,previousPage:1,previousDate:new Date(0)}},methods:{baseLayerDraw:function(){var e=this.divisor,t=this.keyNum,a=this.editorWidth,i=this.stage,r=this.baseLayer,s=this.notesLayer,n=this.currentPositionLayer;r.destroyChildren();for(var o=0;o<t;o++){var u=(o+1)*K,c=this.keyConfig[this.keyKind].colorGroup,d=O[c[o]],l=new _.a.Rect({x:u-K,width:K,height:S,fill:d,strokeWidth:0});r.add(l);var f=new _.a.Line({points:[u,0,u,S],stroke:"#969696",strokeWidth:.5});r.add(f)}for(var p=0;p<k/e;p++){var h=(p+1)*e;f=new _.a.Line({points:[0,h,a,h],stroke:"#969696",strokeWidth:e*(p+1)%D==0?1:.5});r.add(f)}var m=new _.a.Rect({width:a,height:S,stroke:"black",strokeWidth:1});r.add(m);for(o=0;o<t;o++){u=(o+1)*K;var v=this.keyConfig[this.keyKind],y=(c=v.colorGroup,d=P[c[o]],v.chars);if(y){var g=y[o],b=new _.a.Text({x:u-K,y:S+5,width:K,align:"center",verticalAlign:"middle",text:g,fontSize:11,fill:d});r.add(b)}}i.add(r),i.add(s),i.add(n)},playMusicLoop:function(e){var t=this,a=-k/4,i=k,r=I(e,this.page,a),s=I(e,this.page,i),n=this.musicVolume,o=this.musicRate,u=function(e,a){var i=1e3*(a-e)/o;if(t.musicService.play(e,n,o),t.currentPositionService.musicAnimate(i),t.musicTimer){var r=setTimeout((function(){t.musicService.pause(),u(e,a)}),i);t.musicTimer=r}};this.musicTimer=1,u(r,s)},stopMusicLoop:function(e){var t=this.stage,a=this.currentPositionLayer,i=a.findOne("#musicPosition");i.destroy(),t.add(a),this.musicService.pause(e),this.musicTimer=null},displayPageScore:function(e){var t=this,a=this.stage,i=this.notesLayer,r=this.noteService,s=this.speedPieceService,n=this.scoreData.scores[e-1];i.destroyChildren(),a.add(i),n.notes.forEach((function(e,t){e.forEach((function(e){r.draw(t,e,!1)}))})),n.freezes.forEach((function(e,a){e.forEach((function(e){r.draw(a,e,!0)})),r.fillFreeze(t.page,a)})),n.speeds.forEach((function(e){s.draw(e.position,e.type)}))},pageMove:function(e){var t=this;this.page=e,this.$emit("page-jump",e),this.scoreData.scores[e]||(this.scoreData.scores.length=e+1),this.scoreData.scores=Object(m["c"])(this.scoreData.scores).map((function(e){return e||new b(t.keyNum)})),this.displayPageScore(e),this.musicTimer&&(this.stopMusicLoop(this.musicTimer),this.playMusicLoop(this.timing)),this.currentPositionService.draw(this.currentPosition,e,this.timing)},pageMinus:function(e,t){void 0===t&&(t=0),this.$emit("page-minus",e),this.currentPositionService.move(t,this.page,this.timing)},pagePlus:function(e){this.$emit("page-plus",e),this.currentPositionService.move(0,this.page,this.timing)},changeDivisor:function(e){this.divisor=e,this.currentPosition%e!==0&&this.currentPositionService.move(Math.floor(this.currentPosition/e)*e,this.page,this.timing),this.baseLayerDraw()},currentPositionIncrease:function(){this.currentPosition+=this.divisor,this.currentPosition>=k?this.pagePlus(1):this.currentPositionService.move(this.currentPosition,this.page,this.timing)},currentPositionDecrease:function(){this.currentPosition-=this.divisor,this.currentPosition<0?1===this.page?this.currentPosition=0:this.pageMinus(1,this.currentPosition+k):this.currentPositionService.move(this.currentPosition,this.page,this.timing)},keydownAction:function(e){var t,a=this,i=this.noteService,r=this.speedPieceService,s=this.pageScoreService,n=this.page,o=this.currentPosition,u=this.divisor,c=function(e){return e===a.isReverse?a.currentPositionDecrease:a.currentPositionIncrease},d=function(e){switch(e.code){case"KeyX":e.shiftKey?s.delete(n):s.cut(n);break;case"KeyC":s.copy(n);break;case"KeyV":e.shiftKey?s.add(n):s.paste(n);break;case"KeyZ":var t=Q(a.operationQueue,i,s),r=t.undoPage,d=t.undoPosition,l=void 0!=r?r:n,f=void 0!=d?d:o;a.pageMove(l),a.currentPositionService.move(f,l,a.timing),a.displayPageScore(l);break;case"ArrowUp":var p=a.isReverse?-u:u;i.shift(n,o,p),c(!0)(),a.displayPageScore(a.page);break;case"ArrowDown":p=a.isReverse?u:-u;i.shift(n,o,p),c(!1)(),a.displayPageScore(a.page);break}},l=function(e){switch(e.code){case"Digit1":a.changeDivisor(D);break;case"Digit2":a.changeDivisor(D/2);break;case"Digit3":a.changeDivisor(D/4);break;case"Digit4":a.changeDivisor(D/3);break;case"Digit5":a.changeDivisor(D/6);break;case"Digit6":a.changeDivisor(D/12);break;case"Digit7":a.changeDivisor(D/8);break}};if(e.ctrlKey)d(e),l(e);else switch(e.code){case"Enter":if(this.musicTimer){var f=this.musicTimer;this.stopMusicLoop(f)}else{var p=this.timing;this.playMusicLoop(p)}break;case"Backspace":i.removeOnPosition(this.page,this.currentPosition),this.displayPageScore(this.page);break;case"Space":this.currentPositionIncrease();break;case"ArrowUp":c(!0)();break;case"KeyB":this.currentPositionDecrease();break;case"ArrowDown":c(!1)();break;case"ArrowLeft":e.shiftKey?this.pageMinus(5):this.pageMinus(1);break;case"ArrowRight":e.shiftKey?this.pagePlus(5):this.pagePlus(1);break;case"Quote":var h=e.shiftKey?"boost":"speed",m=this.page,v=this.currentPosition;r.hasSpeedPiece(m,v)?(r.remove(m,v),r.clear(v)):(r.add(m,v,h),r.draw(v,h));break;default:var y=Math.max(this.keyConfig[this.keyKind].keys.indexOf(e.code),this.keyConfig[this.keyKind].alternativeKeys.indexOf(e.code)),g=e.shiftKey,_=this.page,b=(v=this.currentPosition,!1);if(y>=0){var K=new Date,z=JSON.parse(null!==(t=localStorage.getItem("simultaneousThreshold"))&&void 0!==t?t:"30");K.getTime()-this.previousDate.getTime()<=z?(_=this.previousPage,v=this.previousPosition,b=!0):this.previousDate=K,i.hasNote(_,y,v).exists?i.removeOne(_,this.page,y,v):i.addOne(_,this.page,y,v,g),b||(this.currentPositionIncrease(),this.previousPage=_,this.previousPosition=v)}else l(e);break}}},computed:{mode:function(){return D/this.divisor*4},moveIntervalFrame:function(){return Math.round(100*(U(this.timing,this.page,this.divisor)-U(this.timing,this.page,0)))/100}},mounted:function(){var e=this,t=new _.a.Stage({x:w,y:C,container:"canvas",width:this.editorWidth+2*w,height:S+2*C}),a=new _.a.Layer({container:"baseLayer"}),i=new _.a.Layer({container:"currentPositionLayer"}),r=new _.a.Layer({container:"notesLayer"});this.stage=t,this.baseLayer=a,this.currentPositionLayer=i,this.notesLayer=r,this.noteService=new M(this.scoreData,this.keyConfig,this.keyKind,this.isReverse,this.stage,this.notesLayer,this.operationQueue),this.speedPieceService=new T(this.scoreData,this.editorWidth,this.isReverse,this.stage,this.notesLayer),this.pageScoreService=new E(this.scoreData,this.copyScoreStore,this.keyNum,this.displayPageScore,this.operationQueue),this.currentPositionService=new A(this.scoreData,this.editorWidth,this.isReverse,this.stage,this.currentPositionLayer,(function(t){return e.currentPosition=t})),this.baseLayerDraw(),this.currentPositionService.draw(0,1,this.timing),this.pageMove(1),this.displayPageScore(1),this.$refs.canvas instanceof HTMLElement&&this.$refs.canvas.focus()},beforeDestroy:function(){this.musicTimer&&this.stopMusicLoop(this.musicTimer)},watch:{pageNum:function(e){this.pageMove(e)},scoreData:function(e){this.$emit("changeScoreData",e)},propScoreNumber:function(e){this.scoreData.scoreNumber=e}}}),Y=q,ee=Object(u["a"])(Y,v,y,!1,null,null,null),te=ee.exports,ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"uk-modal-dialog",attrs:{id:"editor-option","uk-modal":"",container:"#editor-controller"}},[a("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""}}),a("h2",{staticClass:"uk-modal-title"},[e._v("Option Settings")]),a("div",{staticClass:"option-item-container",attrs:{id:"option-score-number"}},[a("div",{staticClass:"menu-txt"},[e._v("Score No.")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.inputScoreNumber,expression:"inputScoreNumber",modifiers:{number:!0}}],staticClass:"uk-input uk-form-small",attrs:{type:"number",min:"1"},domProps:{value:e.inputScoreNumber},on:{input:function(t){t.target.composing||(e.inputScoreNumber=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),a("div",{staticClass:"option-item-container",attrs:{id:"option-music-volume"}},[a("div",{staticClass:"menu-txt"},[e._v("Music Volume")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.inputMusicVolume,expression:"inputMusicVolume",modifiers:{number:!0}}],staticClass:"uk-range uk-form-small",attrs:{type:"range",min:"0",max:"1",step:"0.05"},domProps:{value:e.inputMusicVolume},on:{__r:function(t){e.inputMusicVolume=e._n(t.target.value)},blur:function(t){return e.$forceUpdate()}}})]),a("div",{staticClass:"option-item-container",attrs:{id:"option-music-rate"}},[a("div",{staticClass:"menu-txt"},[e._v("Music Speed")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.inputMusicRate,expression:"inputMusicRate",modifiers:{number:!0}}],staticClass:"uk-input uk-form-small",attrs:{type:"number",min:"0.25",max:"2",step:"0.05"},domProps:{value:e.inputMusicRate},on:{input:function(t){t.target.composing||(e.inputMusicRate=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})])])},ie=[],re=i["a"].extend({name:"EditorOption",props:{scoreNumber:Number,musicVolume:Number,musicRate:Number},computed:{inputScoreNumber:{get:function(){return this.scoreNumber},set:function(e){var t=Number(e);this.$emit("update:scoreNumber",t)}},inputMusicVolume:{get:function(){return this.musicVolume},set:function(e){localStorage.setItem("musicVolume",e);var t=Number(e);this.$emit("update:musicVolume",t)}},inputMusicRate:{get:function(){return this.musicRate},set:function(e){var t=Number(e);this.$emit("update:musicRate",t)}}}}),se=re,ne=Object(u["a"])(se,ae,ie,!1,null,null,null),oe=ne.exports,ue=function(){function e(e){this.blankFrame=200,this.timings=[{label:1,startNum:0,bpm:140}],this.scoreNumber=1,this.scores=[new b(e)]}return e}(),ce=function(){function e(e,t){this.keyKind=e,this.keyConfig=t,this.keyNum=this.keyConfig[this.keyKind].num,this.defaultPageScore=new b(this.keyNum)}return e.prototype.toFrameData=function(e){for(var t=new b(this.keyNum),a=e.blankFrame,i=e.timings.sort((function(e,t){return e.label-t.label})),r=e.scores,s=0,n=r.length+1,o=[],u=function(e){var n=r[e-1];if(void 0===n)o.push(t);else{i[s]&&e===i[s].label&&s++;var u=i[s-1],c=function(t){return Math.round(U(u,e,t,a))},d=n.notes.map((function(e){return e.sort((function(e,t){return e-t})).map(c)})),l=n.freezes.map((function(e){return e.sort((function(e,t){return e-t})).map(c)})),f=n.speeds.map((function(e){var t=Object(F["cloneDeep"])(e);return t.position=c(e.position),t}));o.push({notes:d,freezes:l,speeds:f})}},c=1;c<n;c++)u(c);return o},e.prototype.framesToOutputData=function(e){var t=this,a={notes:new Array(this.keyNum).fill([]).map((function(){return[]})),freezes:new Array(this.keyNum).fill([]).map((function(){return[]})),speeds:[],boosts:[]},i=e.reduce((function(e,a){for(var i=0;i<t.keyNum;i++)e.notes[i]=e.notes[i].concat(a.notes[i]),e.freezes[i]=e.freezes[i].concat(a.freezes[i]);return e.speeds=e.speeds.concat(a.speeds.filter((function(e){return"speed"===e.type}))),e.boosts=e.boosts.concat(a.speeds.filter((function(e){return"boost"===e.type}))),e}),a);return i},e.prototype.makeEasySave=function(e){var t=e.keyKind,a=e.blankFrame,i=e.timings.map((function(e){return e.label})),r=e.timings.map((function(e){return e.startNum})),s=e.timings.map((function(e){return e.bpm})),n=e.scoreNumber||1,o="|es_keyKind="+t+"|es_blankFrame="+a+"|es_label="+i.join(",")+"|es_startNumber="+r.join(",")+"|es_bpm="+s.join(",")+"|es_scoreNumber="+n+"|";return o},e.prototype.convert=function(e,t){var a=this;void 0===t&&(t="");var i=this.toFrameData(e),r=this.framesToOutputData(i);r.speeds.sort((function(e,t){return e.position-t.position})),r.boosts.sort((function(e,t){return e.position-t.position}));var s=r.notes.reduce((function(e,t,i){return""+e+a.keyConfig[a.keyKind].noteNames[i]+"="+t.join(",")+"|"}),"|").replace(/_/g,t+"_"),n=r.freezes.reduce((function(e,t,i){return""+e+a.keyConfig[a.keyKind].freezeNames[i]+"="+t.join(",")+"|"}),"").replace(/_/g,t+"_"),o=("speed_data="+r.speeds.map((function(e){return e.position+","+e.value})).join(",")+"|").replace(/_/g,t+"_"),u=("boost_data="+r.boosts.map((function(e){return e.position+","+e.value})).join(",")+"|").replace(/_/g,t+"_"),c=this.makeEasySave(e);return s+n+"\n|"+(o+u)+"\n"+c+"\n"},e.prototype.cutLastDefault=function(e){var t=e.scores.length,a=Object(F["cloneDeep"])(e),i=t-1;while(i>=0){if(!Object(F["isEqual"])(a.scores[i],this.defaultPageScore))break;a.scores.pop(),i--}return a},e.prototype.convertWithQuarters=function(e,t){void 0===t&&(t="");for(var a=[],i=0;i<8;i++)a.push(i*D);var r=20,s=0,n=this.cutLastDefault(Object(F["cloneDeep"])(e));for(i=0;i<r;i++){var o=new b(this.keyNum);o.notes[s]=a,n.scores.push(o)}return this.convert(this.cutLastDefault(n),t)},e.prototype.save=function(e){return JSON.stringify(this.cutLastDefault(e))},e}(),de=function(){function e(){}return e.prototype.calcFlattenData=function(e,t){var a={allScorebook:[],frzStartData:[],frzEndData:[]};return t.forEach((function(e){a.frzStartData=a.frzStartData.concat(e.filter((function(e,t){return t%2==0}))),a.frzEndData=a.frzEndData.concat(e.filter((function(e,t){return t%2==1})))})),a.frzStartData.sort((function(e,t){return e-t})),a.frzEndData.sort((function(e,t){return e-t})),a.allScorebook=Object(F["flattenDeep"])(e.concat(a.frzStartData)).sort((function(e,t){return e-t})),a},e.prototype.calcLaneContinuous=function(e,t){for(var a=e.length,i=0,r=function(a){var r=e[a].concat(t[a].filter((function(e,t){return t%2==0}))).sort((function(e,t){return e-t}));i+=r.reduce((function(e,t,a){var i=10,s=0!==a?t-r[a-1]:i,n=s<i?i/Math.pow(s,2)-1/i:0;return e+n}),0)},s=0;s<a;s++)r(s);return i},e.prototype.calcAdjustValue=function(e){var t=Object(F["cloneDeep"])(e),a=t.allScorebook,i=t.frzStartData,r=t.frzEndData;a.unshift(a[0]-100),a.push(a[a.length-1]+100);var s=0,n=Object(F["uniq"])(a),o={level:0,single:0,double:0,overTriple:0,overTripleFrame:[],laneContinuous:0};return n.forEach((function(e,t){var u=n[t+1],c=r.filter((function(t){return t<e})).length;if(s-=c,r.splice(0,c),t!==n.length-1&&0!==t){var d=a.filter((function(t){return t===e})).length;if(d+s>2&&(o.overTriple+=Math.min(d,d+s-2),o.overTripleFrame.push(e)),d>=2&&0===s){var l=40/((e-n[t-1])*(u-e));o.double+=l}var f=i.filter((function(t){return t===e})).length;s+=f,i.splice(0,f);var p=r.filter((function(e){return e<u})).length;if(s-=p,r.splice(0,p),s<2){var h=2/((2-s)*(u-e));o.single+=h}}})),o},e.prototype.calcLevel=function(e,t){var a=this.calcFlattenData(e,t),i=this.calcLaneContinuous(e,t),r=this.calcAdjustValue(a);r.laneContinuous=i;var s=a.allScorebook.length;if(0===s)return r;if(1===s)return Object.assign(r,{level:.01});var n=function(e){return e/Math.sqrt(s-1-r.overTriple)*4},o=n(r.single+r.double+r.laneContinuous);r.single=n(r.single),r.double=n(r.double),r.laneContinuous=n(r.laneContinuous);var u=o*(s-1)/(s-1-r.overTriple),c=Math.round(100*u)/100;return Object.assign(r,{level:c})},e.prototype.countNotes=function(e,t){var a=e.map((function(e){return e.length})),i=t.map((function(e){return e.length/2}));return{notesCountArr:a,freezesCountArr:i}},e.prototype.createScoreDataInfoStr=function(e,t){var a=this.calcLevel(e,t),i="ツール値: "+a.level+(a.overTriple>0?"*":""),r="同時補正: "+a.double,s="縦連補正: "+a.laneContinuous,n=this.countNotes(e,t),o=Object(F["sum"])(n.notesCountArr),u=Object(F["sum"])(n.freezesCountArr),c="矢印数: "+(o+u)+"("+o+" + "+u+")",d="通常ノーツ: ("+n.notesCountArr.join("/")+")",l="氷矢: ("+n.freezesCountArr.join("/")+")",f="3押し位置: ("+a.overTripleFrame.join("/")+")",p=i+"\n"+r+"\n"+s+"\n"+c+"\n"+d+"\n"+l+"\n"+f;return p},e}(),le=function(){function e(e){var t=this;this.keyConfig=e,this.delimiter="|",this.calcScoreData=function(e,a,i){var r=i.keyKind,s=i.scoreNumber,n=t.keyConfig[r].noteNames,o=t.keyConfig[r].freezeNames,u="speed_data"in e?["speed_data","boost_data"]:["speed_change","boost_data"],c=[n,o,u].map((function(t){return t.map((function(e){return e.replace(s.toString(),"")})).map((function(t){return e[t].split(",").filter((function(e){return e})).map((function(e){return Number(e)}))}))})),d=c[0],l=c[1],f=c[2],p=Math.max(t.findMaxNumber(d),t.findMaxNumber(l)),h=j(a.slice(-1)[0],p,i.blankFrame).page,m=t.makeScores(d,a,i,h),v=t.makeScores(l,a,i,h),y=f[0].filter((function(e,t){return t%2==0})),g=f[0].filter((function(e,t){return t%2==1})),_=f[1].filter((function(e,t){return t%2==0})),b=f[1].filter((function(e,t){return t%2==1})),K=y.map((function(e,t){return{frame:e,value:g[t],type:"speed"}})).concat(_.map((function(e,t){return{frame:e,value:b[t],type:"boost"}}))).sort((function(e,t){return e.frame-t.frame})),z=new Array(h).fill([]).map((function(){return[]}));K.forEach((function(e){var t=e.frame,r=e.value,s=e.type,n=i.blankFrame,o=0;while(o+1<a.length&&t>=a[o+1].startNum+n)o++;var u=j(a[o],t,n),c=u.page,d=u.position;c>=1&&d>=0&&z[c-1].push({position:d,value:r,type:s})}));var k=new Array(h).fill({}).map((function(e,t){return{notes:m[t],freezes:v[t],speeds:z[t]}}));return i.scores=k,i}}return e.prototype.dosConvert=function(e){var t=/scoreNumber=(\d+)/.exec(e),a=t?t[1]:"1",i=RegExp(a+"_","g"),r=Object(F["compact"])(e.replace(i,"_").replace(/&/g,"|").replace(/\|es_/g,"|").replace(/\n/g,"").split(this.delimiter)),s=Object(F["fromPairs"])(r.map((function(e){return e.split("=")})));try{var n=this.fromOldCWToNewCW(s),o=n["keyKind"],u=parseInt(n["blankFrame"]),c=n["label"].split(",").map((function(e){return parseInt(e)})),d=n["startNumber"].split(",").map((function(e){return parseFloat(e)})),l=n["bpm"].split(",").map((function(e){return parseFloat(e)})),f=parseInt(n["scoreNumber"]),p=c.map((function(e,t){return{label:e,startNum:d[t],bpm:l[t]}})),h={keyKind:o,blankFrame:u,timings:p,scoreNumber:f,scores:[]};return this.calcScoreData(n,p,h)}catch(m){return null}},e.prototype.findMaxNumber=function(e){return e.reduce((function(e,t){return Math.max(e,0|t.slice(-1)[0])}),0)},e.prototype.makeScores=function(e,t,a,i){var r=e.length,s=a.blankFrame,n=new Array(i).fill([]).map((function(){return new Array(r).fill([]).map((function(){return[]}))}));return e.forEach((function(e,a){var i=0;e.forEach((function(e){while(i+1<t.length&&e>=t[i+1].startNum+s)i++;var r=j(t[i],e,s),o=r.page,u=r.position;o>=1&&u>=0&&n[o-1][a].push(u)}))})),n},e.prototype.fromOldCWToNewCW=function(e){try{var t=e["difData"].split(","),a=e["first_num"].split(",").map((function(e){return Number(e)})),i=e["haba_num"].split(",").map((function(e){return Number(e)})),r=e["haba_page_num"].split(",").map((function(e){return Number(e)}));e.keyKind=t[0],e.blankFrame="200";var s=0;e.label=r.map((function(e){return 2*e+1})).map((function(e,t){return 0!=t&&r[t]-r[t-1]&&s++,Math.ceil(e+s)})).join(","),e.startNumber=a.map((function(e){return e-200})).join(","),e.bpm=i.map((function(e){return 1800/e})).join(",");var n=Object.keys(e).join(","),o=/(\d+)_/.exec(n);return e.scoreNumber=o?o[1]:"1",e}catch(u){return e}},e}(),fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"uk-modal-dialog",attrs:{id:"editor-save","uk-modal":"",container:"#editor-controller"}},[a("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""}}),a("h2",{staticClass:"uk-modal-title"},[e._v("Save")]),e._m(0),a("div",{staticClass:"save-item-container",attrs:{id:"save-key-phrase"}},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.inputKeyPhrase,expression:"inputKeyPhrase",modifiers:{trim:!0}}],staticClass:"uk-input uk-form-small",attrs:{type:"text",max:"50",list:"phrase-history"},domProps:{value:e.inputKeyPhrase},on:{input:function(t){t.target.composing||(e.inputKeyPhrase=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),a("datalist",{attrs:{id:"phrase-history"}},e._l(e.phraseHistory,(function(t){return a("option",{key:t},[e._v(e._s(t))])})),0)]),a("div",{staticClass:"save-item-container",staticStyle:{display:"flex"}},[a("div",{staticClass:"save-output-btn btn-red",on:{click:e.submitPhrase}},[e._v("OK")]),a("div",{staticClass:"save-output-btn btn-gray",on:{click:e.resetForm}},[e._v("RESET")])])])},pe=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"save-item-container",attrs:{id:"save-key-phrase"}},[a("div",{staticClass:"save-txt"},[e._v(" キーフレーズを入力して下さい。"),a("br"),e._v(" (無入力の場合はセーブデータをクリップボードにコピーします。) ")])])}],he=i["a"].extend({name:"EditorOption",data:function(){var e=JSON.parse(localStorage.getItem("keyPhrases")||"[]");return{keyPhrase:"",phraseHistory:e}},computed:{inputKeyPhrase:{get:function(){return this.keyPhrase},set:function(e){this.keyPhrase=e}}},methods:{submitPhrase:function(){var e=this.keyPhrase,t=10;if(this.phraseHistory.includes(e)){var a=this.phraseHistory.filter((function(t){return t!==e}));a.unshift(e),this.phraseHistory=a}else this.phraseHistory.unshift(e),this.phraseHistory.length>t&&this.phraseHistory.pop();localStorage.setItem("keyPhrases",JSON.stringify(this.phraseHistory)),this.$emit("save",e)},resetForm:function(){this.keyPhrase=""}}}),me=he,ve=Object(u["a"])(me,fe,pe,!1,null,null,null),ye=ve.exports,ge=i["a"].extend({name:"EditorController",components:{EditorMain:te,EditorOption:oe,EditorSave:ye},props:{selectedKey:String,loadScoreDataStr:String,loadMusicUrl:String},data:function(){var e,t=Z(),a=sessionStorage.getItem("keyKind"),i=a||this.selectedKey,r=t[i].num,s=new le(t);try{e=this.loadScoreDataStr?null!=s.dosConvert(this.loadScoreDataStr)?s.dosConvert(this.loadScoreDataStr):JSON.parse(this.loadScoreDataStr):new ue(r),0===e.scores.length&&e.scores.push(new b(r))}catch(o){alert("不正な譜面データが与えられたため、正しく読み込めませんでした。"),e=new ue(r)}var n=e.keyKind||i;return e.keyKind=n,sessionStorage.setItem("keyKind",n),{pageNum:1,labelNum:1,timing:e.timings[0],scoreData:e,keyKind:n,keyConfig:t,scoreNumber:e.scoreNumber?e.scoreNumber:1,musicVolume:Number(localStorage.getItem("musicVolume"))||1,musicRate:1,scoreConvertService:new ce(n,t)}},methods:{pageMinus:function(e){this.pageNum=Math.max(1,this.pageNum-e)},pagePlus:function(e){this.pageNum+=e},pageJump:function(e){this.pageNum=e},labelMinus:function(e){this.labelNum=Math.max(1,this.labelNum-e),this.labelMove(this.labelNum),this.pageNum=this.scoreData.timings[this.labelNum-1].label},labelPlus:function(e){this.labelNum=Math.min(this.scoreData.timings.length,this.labelNum+e),this.labelMove(this.labelNum),this.pageNum=this.scoreData.timings[this.labelNum-1].label},labelMove:function(e){var t=this.scoreData.timings[e-1];this.labelNum=e,this.timing=t},changeScoreData:function(e){this.scoreData=e},writeClipBoard:function(e,t){navigator.clipboard&&(navigator.clipboard.writeText(e),alert(t))},convert:function(){var e=1!==this.scoreData.scoreNumber&&this.scoreData.scoreNumber?this.scoreData.scoreNumber.toString():"",t=this.scoreConvertService,a=t.convert(this.scoreData,e),i="譜面データをクリップボードにコピーしました！";this.writeClipBoard(a,i),localStorage.setItem("saveData",t.save(this.scoreData))},save:function(e){return Object(m["a"])(this,void 0,Promise,(function(){var t;return Object(m["b"])(this,(function(a){switch(a.label){case 0:return e?[4,this.onlineSave(e)]:[3,2];case 1:return a.sent(),t="セーブデータをオンラインにセーブしました！",alert(t),[3,3];case 2:""===e&&this.localSave(),a.label=3;case 3:return[2]}}))}))},localSave:function(){var e=this.scoreConvertService,t=e.save(this.scoreData),a="セーブデータをクリップボードにコピーしました！";this.writeClipBoard(t,a)},onlineSave:function(e){return Object(m["a"])(this,void 0,Promise,(function(){var t,a,i,r;return Object(m["b"])(this,(function(s){return t=this.scoreConvertService,a=t.save(this.scoreData),i=new XMLHttpRequest,r="https://asia-northeast1-danoni-editor-backend.cloudfunctions.net/addSaveData",i.open("POST",r),i.setRequestHeader("Content-Type","application/json; charset=utf-8"),i.send(JSON.stringify({keyPhrase:e,data:a})),[2]}))}))},convertWithQuarters:function(){var e=1!==this.scoreData.scoreNumber&&this.scoreData.scoreNumber?this.scoreData.scoreNumber.toString():"",t=this.scoreConvertService,a=t.convertWithQuarters(this.scoreData,e),i="四分譜面データをクリップボードにコピーしました！";this.writeClipBoard(a,i)},displayScoreDataInfo:function(){var e=new de,t=this.scoreConvertService.toFrameData(this.scoreData),a=this.scoreConvertService.framesToOutputData(t),i=e.createScoreDataInfoStr(a.notes,a.freezes);alert(i)},getLabelNumByPageNum:function(e){var t=this.scoreData.timings.map((function(e){return e.label}));return t.indexOf(e)},getNearestLabelNumByPageNum:function(e){var t=this.scoreData.timings.map((function(e){return e.label})),a=t.reduce((function(t,a){return a<=e?t+1:t}),0);return a},labelOperation:function(e,t){if(t){var a=this.getLabelNumByPageNum(e);this.scoreData.timings.splice(a,1),this.labelNum--,this.timing=this.scoreData.timings[this.labelNum-1]}else{var i=this.timing,r=60*N/D/i.bpm,s=Math.round(100*(i.startNum+(e-i.label)*k*r))/100,n={label:e,startNum:s,bpm:i.bpm};this.scoreData.timings.splice(this.labelNum,0,n),this.timing=n,this.labelNum++}},callLabelOperation:function(){var e=this.pageNum,t=-1!==this.getLabelNumByPageNum(e);this.labelOperation(e,t),this.pageNum=e}},watch:{pageNum:function(e){var t=this.getNearestLabelNumByPageNum(e);this.labelNum=t,this.labelMove(t)}},mounted:function(){this.scoreData.scoreNumber||(this.scoreData.scoreNumber=1)}}),_e=ge,be=Object(u["a"])(_e,p,h,!1,null,null,null),Ke=be.exports,ze=i["a"].extend({name:"Editor",components:{EditorController:Ke},props:{loadScoreDataStr:String,loadMusicUrl:String,selectedKey:String},beforeRouteLeave:function(e,t,a){var i=window.confirm("内容が消去されますがよろしいですか？");i?a():a(!1)},methods:{beforeunloadAlert:function(e){e.returnValue="内容が消去されますがよろしいですか？"}},created:function(){window.addEventListener("beforeunload",this.beforeunloadAlert)},destroyed:function(){window.removeEventListener("beforeunload",this.beforeunloadAlert)}}),ke=ze,Se=Object(u["a"])(ke,l,f,!1,null,null,null),De=Se.exports,Ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"start"}},[a("start-main")],1)},we=[],Ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"start-container"}},[a("start-load",{on:{load:e.load}}),a("div",{attrs:{id:"start-title"}},[e._v("Dancing☆Onigiri Editor")]),a("div",{attrs:{id:"start-menu"}},[a("start-uploader",{attrs:{msg:e.musicTitle},on:{fileRecieve:e.onMusicFileRecieve}}),a("start-uploader",{attrs:{msg:e.scoreTitle},on:{fileRecieve:e.onScoreFileRecieve}}),a("div",{attrs:{id:"start-go-next"}},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedKey,expression:"selectedKey"}],staticClass:"uk-select uk-form-width-medium",attrs:{id:"start-key-selector"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedKey=t.target.multiple?a:a[0]}}},e._l(e.keyKinds,(function(t){return a("option",{key:t},[e._v(e._s(t))])})),0),a("router-link",{staticClass:"start-btn btn-orange",attrs:{to:{name:"configure",path:"configure"}}},[e._v("CONFIG")]),a("div",{staticClass:"start-btn btn-blue",attrs:{href:"#start-load","uk-toggle":""}},[e._v("LOAD")]),a("router-link",{staticClass:"start-btn btn-red",attrs:{to:{name:"editor",path:"editor",params:{scoreData:e.scoreDataStr,musicUrl:e.musicUrl,key:e.selectedKey}}}},[e._v("START")])],1),a("div",{attrs:{id:"start-version"}},[e._v("ver 3.1.1 created by SKB")])],1)],1)},Pe=[],Le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"start-uploader",on:{dragover:function(t){return t.preventDefault(),e.ondragover.apply(null,arguments)},drop:function(t){return t.preventDefault(),e.ondrop.apply(null,arguments)}}},[a("div",{staticClass:"uk-placeholder uk-text-center uk-margin-remove-bottom start-droparea",attrs:{"uk-form-custom":""}},[a("input",{ref:"input",attrs:{type:"file"},on:{change:e.loadFile}}),a("span",{attrs:{"uk-icon":"icon: upload"}}),a("span",{staticClass:"uk-text-middle"},[e._v(" "+e._s(e.msg)+" ")]),a("span",{staticClass:"uk-text-middle uk-link"},[e._v("参照")])])])},Oe=[],Re=i["a"].extend({name:"StartUploader",props:{msg:String},data:function(){return{vue:this,file:null}},methods:{ondragover:function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},ondrop:function(e){if(e.dataTransfer){var t=e.dataTransfer.files[0]||null;this.file=t}else this.file=null},loadFile:function(e){if(e.target instanceof HTMLInputElement){var t=e.target.files?e.target.files[0]:null;this.file=t}else this.file=null}},watch:{file:function(e){null!==e?this.$emit("fileRecieve",e):alert("ファイルが見つかりませんでした。")}}}),xe=Re,Fe=Object(u["a"])(xe,Le,Oe,!1,null,null,null),Me=Fe.exports,Te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"uk-modal-dialog",attrs:{id:"start-load","uk-modal":"",container:"#start-container"}},[a("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""}}),a("h2",{staticClass:"uk-modal-title"},[e._v("Load")]),e._m(0),a("div",{staticClass:"save-item-container",attrs:{id:"save-key-phrase"}},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.inputKeyPhrase,expression:"inputKeyPhrase",modifiers:{trim:!0}}],staticClass:"uk-input uk-form-small",attrs:{type:"text",max:"50",list:"phrase-history"},domProps:{value:e.inputKeyPhrase},on:{input:function(t){t.target.composing||(e.inputKeyPhrase=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),a("datalist",{attrs:{id:"phrase-history"}},e._l(e.phraseHistory,(function(t){return a("option",{key:t},[e._v(e._s(t))])})),0)]),a("div",{staticClass:"save-item-container",staticStyle:{display:"flex"}},[a("div",{staticClass:"save-output-btn btn-red",on:{click:e.submitPhrase}},[e._v("OK")]),a("div",{staticClass:"save-output-btn btn-gray",on:{click:e.resetForm}},[e._v("RESET")])])])},Ee=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"save-item-container",attrs:{id:"save-key-phrase"}},[a("div",{staticClass:"save-txt"},[e._v(" キーフレーズを入力して下さい。"),a("br"),e._v(" (無入力の場合は最後に出力した譜面データを表示します。) ")])])}],Ue=i["a"].extend({name:"EditorOption",data:function(){var e=JSON.parse(localStorage.getItem("keyPhrases")||"[]");return{keyPhrase:"",phraseHistory:e}},computed:{inputKeyPhrase:{get:function(){return this.keyPhrase},set:function(e){this.keyPhrase=e}}},methods:{submitPhrase:function(){var e=this.keyPhrase;this.$emit("load",e)},resetForm:function(){this.keyPhrase=""}}}),je=Ue,Ie=Object(u["a"])(je,Te,Ee,!1,null,null,null),Ge=Ie.exports,Ae=i["a"].extend({name:"StartMain",components:{StartUploader:Me,StartLoad:Ge},data:function(){var e=Z();return{keyConfig:e,musicTitle:"楽曲ファイルをドロップ",scoreTitle:"セーブファイルをドロップ",selectedKey:"5",musicUrl:null,scoreDataStr:null}},computed:{keyKinds:function(){var e=this.keyConfig,t=Object.keys(e);return t.sort((function(t,a){return e[t].id-e[a].id})),t},localSaveDataStr:function(){var e;return null!==(e=localStorage.getItem("saveData"))&&void 0!==e?e:""}},methods:{onMusicFileRecieve:function(e){var t=this,a="audio.*";if(e.type.match(a)){var i=new FileReader;i.onload=function(){var a=i.result;"string"==typeof a&&(t.musicUrl=a,t.musicTitle=e.name)},i.readAsDataURL(e)}else alert("音楽ファイルではありません。")},onScoreFileRecieve:function(e){var t=this,a="(application/json|text/plain)";if(e.type.match(a)){var i=new FileReader;i.onload=function(){var a=i.result;"string"==typeof a&&(t.scoreDataStr=a,t.scoreTitle=e.name)},i.readAsText(e)}else alert("譜面ファイルではありません。")},moveToEditor:function(e,t,a){this.$router.push({name:"editor",path:"editor",params:{scoreData:e,musicUrl:t,key:a}})},loadData:function(e){return Object(m["a"])(this,void 0,void 0,(function(){var t,a,i;return Object(m["b"])(this,(function(r){switch(r.label){case 0:return t="https://asia-northeast1-danoni-editor-backend.cloudfunctions.net/getSaveData?keyPhrase="+e,[4,fetch(t)];case 1:return a=r.sent(),[4,a.json()];case 2:return i=r.sent(),[2,JSON.stringify(i.data||"")]}}))}))},load:function(e){return Object(m["a"])(this,void 0,Promise,(function(){var t,a;return Object(m["b"])(this,(function(i){switch(i.label){case 0:return null!==e?[3,1]:[2];case 1:return""!==e?[3,2]:(this.moveToEditor(this.localSaveDataStr,this.musicUrl||"",this.selectedKey),[3,5]);case 2:return i.trys.push([2,4,,5]),[4,this.loadData(e)];case 3:return t=i.sent(),a=t.replaceAll('\\"','"').slice(1).slice(0,-1),this.moveToEditor(a,this.musicUrl||"",this.selectedKey),[3,5];case 4:return i.sent(),alert("セーブデータの取得が出来ませんでした。"),[3,5];case 5:return[2]}}))}))}},mounted:function(){sessionStorage.removeItem("keyKind")}}),Je=Ae,He=Object(u["a"])(Je,Ce,Pe,!1,null,null,null),$e=He.exports,Ve=i["a"].extend({name:"Start",components:{StartMain:$e}}),We=Ve,Be=Object(u["a"])(We,Ne,we,!1,null,null,null),Qe=Be.exports,Xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"configure"}},[a("configure-main")],1)},Ze=[],qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"configure-container"}},[e._m(0),a("h3",{staticClass:"configure-context-title"},[e._v("Key Config")]),a("div",{attrs:{id:"configure-uploader"}},[a("configure-uploader",{attrs:{msg:e.confTitle},on:{fileRecieve:e.onConfFileRecieve}}),a("div",{staticClass:"start-btn btn-gray",on:{click:e.resetConf}},[e._v("RESET")])],1),a("configure-design"),a("div",{attrs:{id:"start-go-next"}},[a("router-link",{staticClass:"start-btn btn-blue",attrs:{to:{name:"start",path:"/"}}},[e._v("BACK")])],1)],1)},Ye=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"configure-title"}},[a("h2",[e._v("Configure")])])}],et=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"configure-conf-select"},on:{dragover:function(t){return t.preventDefault(),e.ondragover.apply(null,arguments)},drop:function(t){return t.preventDefault(),e.ondrop.apply(null,arguments)}}},[a("div",{staticClass:"uk-placeholder uk-text-center uk-margin-remove-bottom uk-form-width-medium",attrs:{"uk-form-custom":"",id:"configure-droparea"}},[a("input",{ref:"input",attrs:{type:"file",id:"configure-droparea-input"},on:{change:e.loadFile}}),a("div",{attrs:{id:"configure-droparea-text"}},[a("span",{attrs:{"uk-icon":"icon: upload"}}),a("span",{staticClass:"uk-text-middle"},[e._v(e._s(e.msg))]),a("span",{staticClass:"uk-text-middle uk-link"},[e._v("参照")])])])])},tt=[],at=i["a"].extend({name:"ConfigureUploader",props:{msg:String},data:function(){return{vue:this,file:null}},methods:{ondragover:function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},ondrop:function(e){if(e.dataTransfer){var t=e.dataTransfer.files[0]||null;this.file=t}else this.file=null},loadFile:function(e){if(e.target instanceof HTMLInputElement){var t=e.target.files?e.target.files[0]:null;this.file=t}else this.file=null}},watch:{file:function(e){null!==e?this.$emit("fileRecieve",e):alert("ファイルが見つかりませんでした。")}}}),it=at,rt=Object(u["a"])(it,et,tt,!1,null,null,null),st=rt.exports,nt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h3",{staticClass:"configure-context-title"},[e._v("Options")]),a("div",{staticClass:"configure-design-item"},[a("div",{staticClass:"configure-design-text"},[e._v("Direction:")]),a("div",{staticClass:"configure-options"},[a("div",{staticClass:"configure-radio"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.isReverse,expression:"isReverse"}],staticClass:"uk-radio",attrs:{type:"radio",name:"editor-direction"},domProps:{value:!1,checked:e._q(e.isReverse,!1)},on:{change:function(t){e.isReverse=!1}}}),e._v("Upward ")])]),a("div",{staticClass:"configure-radio"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.isReverse,expression:"isReverse"}],staticClass:"uk-radio",attrs:{type:"radio",name:"editor-direction"},domProps:{value:!0,checked:e._q(e.isReverse,!0)},on:{change:function(t){e.isReverse=!0}}}),e._v("Downward ")])])])]),a("div",{staticClass:"configure-design-item"},[a("div",{staticClass:"configure-design-text"},[e._v("Freeze Highlight:")]),a("div",{staticClass:"configure-options"},[a("div",{staticClass:"configure-radio"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.isHighlightedFreeze,expression:"isHighlightedFreeze"}],staticClass:"uk-radio",attrs:{type:"radio",name:"editor-highlighted-freeze"},domProps:{value:!0,checked:e._q(e.isHighlightedFreeze,!0)},on:{change:function(t){e.isHighlightedFreeze=!0}}}),a("span",{staticClass:"configure-radio-text"},[e._v("On")])])]),a("div",{staticClass:"configure-radio"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.isHighlightedFreeze,expression:"isHighlightedFreeze"}],staticClass:"uk-radio",attrs:{type:"radio",name:"editor-highlighted-freeze"},domProps:{value:!1,checked:e._q(e.isHighlightedFreeze,!1)},on:{change:function(t){e.isHighlightedFreeze=!1}}}),a("span",{staticClass:"configure-radio-text"},[e._v("Off")])])])])]),a("div",{staticClass:"configure-design-item"},[a("div",{staticClass:"configure-design-text-long"},[e._v(" Simultaneous Threshold(msec): ")]),a("div",{staticClass:"configure-options"},[a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.simultaneousThreshold,expression:"simultaneousThreshold",modifiers:{number:!0}}],staticClass:"uk-input uk-form-small",attrs:{type:"number",min:"-1",max:"1000",step:"1"},domProps:{value:e.simultaneousThreshold},on:{input:function(t){t.target.composing||(e.simultaneousThreshold=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})])])])},ot=[],ut=i["a"].extend({name:"ConfigureDesign",data:function(){return{simultaneousThreshold:0}},mounted:function(){var e;this.simultaneousThreshold=JSON.parse(null!==(e=localStorage.getItem("simultaneousThreshold"))&&void 0!==e?e:"30")},watch:{simultaneousThreshold:function(e){localStorage.setItem("simultaneousThreshold",JSON.stringify(e))}},computed:{isReverse:{get:function(){var e,t=null!==(e=localStorage.getItem("isReverse"))&&void 0!==e?e:"false";return JSON.parse(t)},set:function(e){return localStorage.setItem("isReverse",JSON.stringify(e)),e}},isHighlightedFreeze:{get:function(){var e,t=null!==(e=localStorage.getItem("isHighlightedFreeze"))&&void 0!==e?e:"true";return JSON.parse(t)},set:function(e){return localStorage.setItem("isHighlightedFreeze",JSON.stringify(e)),e}}}}),ct=ut,dt=Object(u["a"])(ct,nt,ot,!1,null,null,null),lt=dt.exports,ft=i["a"].extend({name:"ConfigureMain",components:{ConfigureUploader:st,ConfigureDesign:lt},data:function(){return{confTitle:"ファイルをドロップ"}},methods:{onConfFileRecieve:function(e){var t=localStorage,a="(application/json|text/plain)";if(e.type.match(a)){var i=new FileReader;i.onload=function(){var e=i.result;if("string"==typeof e)try{JSON.parse(e),t.setItem("customKeyConfig",e),alert("コンフィグファイルをインポートしました。")}catch(a){alert("内容がJSON形式になっていません。")}},i.readAsText(e)}else alert("コンフィグファイルではありません。")},resetConf:function(){var e=localStorage;e.removeItem("customKeyConfig"),alert("キー設定をリセットしました。")}}}),pt=ft,ht=Object(u["a"])(pt,qe,Ye,!1,null,null,null),mt=ht.exports,vt=i["a"].extend({name:"Configure",components:{ConfigureMain:mt}}),yt=vt,gt=Object(u["a"])(yt,Xe,Ze,!1,null,null,null),_t=gt.exports,bt=a("8c4f");i["a"].config.productionTip=!1,i["a"].use(bt["a"]);var Kt=new bt["a"]({routes:[{path:"/",name:"start",component:Qe},{path:"/editor",name:"editor",component:De,props:function(e){return{loadScoreDataStr:e.params.scoreData,loadMusicUrl:e.params.musicUrl,selectedKey:e.params.key||"7"}}},{path:"/configure",name:"configure",component:_t}]}),zt=a("8323"),kt=a.n(zt),St=a("263c"),Dt=a.n(St),Nt=(a("30b0"),a("d0e7"),a("d40a")),wt=a.n(Nt);wt.a.install(),kt.a.use(Dt.a),i["a"].config.productionTip=!1,new i["a"]({router:Kt,render:function(e){return e(d)}}).$mount("#app")}});
//# sourceMappingURL=app.ed48996b.js.map